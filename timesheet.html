loadCurrentTimesheets() { // MODIFIED to use new rendering
    console.log('loadCurrentTimesheets: Method called.'); // <-- ADD THIS
    const n = new Date();
    const app = this.pp.filter(p => new Date(p.endDate) >= n).slice(0, 4);
    console.log('loadCurrentTimesheets: Filtered pay periods (app):', JSON.parse(JSON.stringify(app))); // <-- ADD THIS
    const c = document.getElementById('ats');
    if (!c) { // <-- ADD THIS BLOCK
        console.error('loadCurrentTimesheets: ERROR - Target element with id "ats" not found!');
        return;
    }
    c.innerHTML = app.map((p, i) => {
        const t = this.getOrCreateTimesheet(this.cu.id, p.id);
        console.log(`loadCurrentTimesheets: Processing pay period ${p.id}, Timesheet data for card ${i + 1}:`, JSON.parse(JSON.stringify(t))); // <-- ADD THIS
        const cardHTML = this.renderWeeklyTimesheetCard(t, p, i + 1, true);
        console.log(`loadCurrentTimesheets: Generated card HTML for week ${i+1}:`, cardHTML.length > 100 ? cardHTML.substring(0,100) + "..." : cardHTML); // <-- ADD THIS (shows a snippet)
        return cardHTML; 
    }).join('');
    this.addPopupCloseListeners();
}